/* ══════════════════════════════════════════════════════════════════════════
   Movie Analyst Agent — Theme Stylesheet  v2.2 (ULTIMATE FIXED)
   Fixes:
   ✅ Landing + Conversation pill buttons: text visible (dark pills + white text)
   ✅ Feature cards: readable by default
   ✅ Removes conflicting / duplicate pill overrides
   Notes:
   - This file styles ONLY the pill buttons inside:
     st.container(key="pill_buttons_landing") and st.container(key="pill_buttons_conv")
   ══════════════════════════════════════════════════════════════════════════ */

/* ── Import font ─────────────────────────────────────── */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

/* ── Root variables ──────────────────────────────────── */
:root {
    --accent:        #E50914;
    --accent-hover:  #B20710;
    --accent-soft:   rgba(229, 9, 20, .08);
    --surface:       #FFFFFF;
    --surface-alt:   #F8F9FB;
    --text-primary:  #141414;
    --text-secondary:#5A5A6E;
    --border:        #E5E7EB;
    --radius:        12px;
    --shadow-sm:     0 1px 3px rgba(0,0,0,.06);
    --shadow-md:     0 4px 16px rgba(0,0,0,.08);
    --shadow-lg:     0 8px 30px rgba(0,0,0,.10);

    --code-bg:       #F3F4F6;
    --code-text:     #1F2937;
    --link-color:    #2563EB;
    --blockquote-border: var(--accent);
}

/* ── Global typography ───────────────────────────────── */
html, body, [class*="css"] {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif !important;
}
.stApp {
    background: var(--surface-alt) !important;
    color: var(--text-primary) !important;
}

/* ── Base text for main area (NO wildcard *) ─────────── */
.stApp .main p,
.stApp .main span,
.stApp .main label,
.stApp .main div,
.stApp .main li {
    color: var(--text-primary);
}
.stApp .main h1, .stApp .main h2, .stApp .main h3, .stApp .main h4 {
    color: var(--text-primary);
}

/* Warnings & errors keep their own colours */
.stApp .main .stAlert,
.stApp .main .stAlert * { color: inherit !important; }

/* ══════════════════════════════════════════════════════════════════════════
   SIDEBAR
   ══════════════════════════════════════════════════════════════════════════ */
section[data-testid="stSidebar"] {
    background: linear-gradient(180deg, #0F0F17 0%, #1A1A2E 100%) !important;
    border-right: 1px solid rgba(255,255,255,.06);
}
section[data-testid="stSidebar"] * {
    color: #D4D4D8 !important;
}
section[data-testid="stSidebar"] .stButton > button {
    background: var(--accent) !important;
    color: #fff !important;
    border: none !important;
    border-radius: 8px !important;
    font-weight: 600 !important;
    padding: .6rem 1rem !important;
    transition: all .2s ease !important;
    letter-spacing: .02em;
    font-size: .85rem !important;
}
section[data-testid="stSidebar"] .stButton > button:hover {
    background: var(--accent-hover) !important;
    box-shadow: 0 4px 20px rgba(229,9,20,.35) !important;
    transform: translateY(-1px);
}
/* secondary sidebar buttons (clear, delete) */
section[data-testid="stSidebar"] .secondary-btn button {
    background: rgba(255,255,255,.06) !important;
    border: 1px solid rgba(255,255,255,.12) !important;
    color: #D4D4D8 !important;
    font-weight: 500 !important;
}
section[data-testid="stSidebar"] .secondary-btn button:hover {
    background: rgba(255,255,255,.12) !important;
    box-shadow: none !important;
    transform: none;
}
section[data-testid="stSidebar"] .stSelectbox [data-baseweb="select"] {
    background: rgba(255,255,255,.07) !important;
    border: 1px solid rgba(255,255,255,.12) !important;
    border-radius: 8px !important;
}
section[data-testid="stSidebar"] hr {
    border-color: rgba(255,255,255,.08) !important;
    margin: .6rem 0 !important;
}

/* ══════════════════════════════════════════════════════════════════════════
   CONVERSATION LIST
   ══════════════════════════════════════════════════════════════════════════ */
.conv-item {
    display: flex; align-items: center; gap: .6rem;
    padding: .55rem .75rem; border-radius: 8px;
    cursor: pointer; transition: all .15s ease;
    margin-bottom: 2px; font-size: .82rem;
    border: 1px solid transparent;
}
.conv-item:hover { background: rgba(255,255,255,.06); }
.conv-item.active {
    background: rgba(229,9,20,.15);
    border-color: rgba(229,9,20,.35);
}
.conv-item .conv-icon { flex-shrink: 0; font-size: .95rem; }
.conv-item .conv-title {
    flex: 1; overflow: hidden; text-overflow: ellipsis;
    white-space: nowrap; font-weight: 500;
    color: #E5E5E5 !important;
}
.conv-item .conv-count {
    font-size: .65rem; background: rgba(255,255,255,.1);
    border-radius: 10px; padding: .1rem .45rem;
    color: rgba(255,255,255,.5) !important;
}
.conv-item.active .conv-title { color: #fff !important; }

/* ══════════════════════════════════════════════════════════════════════════
   CHAT MESSAGES — container
   ══════════════════════════════════════════════════════════════════════════ */
.stChatMessage {
    background: var(--surface) !important;
    border: 1px solid var(--border) !important;
    border-radius: var(--radius) !important;
    box-shadow: var(--shadow-sm) !important;
    padding: 1.1rem 1.3rem !important;
    margin-bottom: .75rem !important;
}
.stChatMessage[data-testid="stChatMessage-user"] {
    border-left: 3px solid var(--accent) !important;
    background: #FFF5F5 !important;
}

/* ── Body text inside chat messages ──────────────────── */
.stChatMessage p,
.stChatMessage li {
    color: var(--text-primary) !important;
    line-height: 1.65;
}

/* ── Headings ────────────────────────────────────────── */
.stChatMessage h1,
.stChatMessage h2,
.stChatMessage h3,
.stChatMessage h4,
.stChatMessage h5,
.stChatMessage h6 {
    color: var(--text-primary) !important;
    font-weight: 700;
    margin-top: 1rem;
    margin-bottom: .4rem;
    line-height: 1.3;
}
.stChatMessage h1 { font-size: 1.5rem; }
.stChatMessage h2 { font-size: 1.3rem; }
.stChatMessage h3 { font-size: 1.12rem; }
.stChatMessage h4 { font-size: 1rem; }

/* ── Links ───────────────────────────────────────────── */
.stChatMessage a {
    color: var(--link-color) !important;
    text-decoration: underline;
    text-decoration-thickness: 1px;
    text-underline-offset: 2px;
}
.stChatMessage a:hover {
    color: var(--accent) !important;
}

/* ── Bold / Italic ───────────────────────────────────── */
.stChatMessage strong,
.stChatMessage b {
    color: var(--text-primary) !important;
    font-weight: 700;
}
.stChatMessage em,
.stChatMessage i {
    color: var(--text-primary) !important;
}

/* ── Inline code ─────────────────────────────────────── */
.stChatMessage code {
    background: var(--code-bg) !important;
    color: var(--code-text) !important;
    padding: .15rem .4rem;
    border-radius: 4px;
    font-size: .88em;
    font-family: 'Fira Code', 'Cascadia Code', 'JetBrains Mono', monospace;
}

/* ── Fenced code blocks ──────────────────────────────── */
.stChatMessage pre {
    background: #1E1E2E !important;
    border: 1px solid #2D2D3D !important;
    border-radius: 8px !important;
    padding: 1rem !important;
    overflow-x: auto;
    margin: .6rem 0;
}
.stChatMessage pre code {
    background: transparent !important;
    color: #D4D4D4 !important;
    padding: 0;
    font-size: .85rem;
    line-height: 1.6;
}

/* ── Blockquotes ─────────────────────────────────────── */
.stChatMessage blockquote {
    border-left: 3px solid var(--blockquote-border);
    padding: .5rem 0 .5rem 1rem;
    margin: .6rem 0;
    background: var(--accent-soft);
    border-radius: 0 6px 6px 0;
}
.stChatMessage blockquote p {
    color: var(--text-secondary) !important;
    font-style: italic;
}

/* ── Tables ──────────────────────────────────────────── */
.stChatMessage table {
    width: 100%;
    border-collapse: collapse;
    margin: .6rem 0;
    font-size: .88rem;
}
.stChatMessage th {
    background: var(--surface-alt) !important;
    color: var(--text-primary) !important;
    font-weight: 600;
    text-align: left;
    padding: .55rem .75rem;
    border-bottom: 2px solid var(--border);
}
.stChatMessage td {
    color: var(--text-primary) !important;
    padding: .5rem .75rem;
    border-bottom: 1px solid var(--border);
}
.stChatMessage tr:hover td {
    background: var(--surface-alt);
}

/* ── Horizontal rules ────────────────────────────────── */
.stChatMessage hr {
    border: none;
    border-top: 1px solid var(--border);
    margin: 1rem 0;
}

/* ── Lists ───────────────────────────────────────────── */
.stChatMessage ul,
.stChatMessage ol {
    padding-left: 1.4rem;
    margin: .4rem 0;
}
.stChatMessage li {
    margin-bottom: .25rem;
}

/* ══════════════════════════════════════════════════════════════════════════
   CHAT INPUT
   ══════════════════════════════════════════════════════════════════════════ */
.stChatInput {
    border-top: 1px solid var(--border) !important;
}
.stChatInput textarea {
    border-radius: var(--radius) !important;
    border: 1px solid var(--border) !important;
    font-size: .95rem !important;
    padding: .85rem 1rem !important;
    color: var(--text-primary) !important;
    background: var(--surface) !important;
    transition: border-color .2s, box-shadow .2s !important;
}
.stChatInput textarea::placeholder { color: #999 !important; }
.stChatInput textarea:focus {
    border-color: var(--accent) !important;
    box-shadow: 0 0 0 3px rgba(229,9,20,.12) !important;
}

/* ── Spinner fix: keep it inline ─────────────────────── */
.stSpinner { display: inline-flex !important; align-items: center !important; }
.stSpinner > div { margin: 0 !important; }

/* ══════════════════════════════════════════════════════════════════════════
   HERO / WELCOME CARD
   ══════════════════════════════════════════════════════════════════════════ */
.hero-card {
    background: linear-gradient(135deg, #695353 0%, #1C1C2E 60%, #2D1B36 100%);
    border-radius: 16px;
    padding: 3rem 2.5rem;
    color: #fff;
    text-align: center;
    box-shadow: var(--shadow-lg);
    margin-bottom: 2rem;
}
.hero-card h1 {
    font-size: 2.6rem; font-weight: 700;
    margin: 0 0 .5rem; letter-spacing: -.02em;
    background: linear-gradient(90deg, #fff 0%, #E0E0E0 100%);
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
}
.hero-card * { color: #fff !important; }
.hero-card .hero-sub {
    font-size: 1.1rem; font-weight: 400;
    margin-bottom: 1.5rem;
    color: rgba(255,255,255,.6) !important;
    -webkit-text-fill-color: rgba(255,255,255,.6);
}
.hero-badge {
    display: inline-block; background: var(--accent);
    color: #fff !important; font-size: .75rem; font-weight: 600;
    padding: .3rem .9rem; border-radius: 20px;
    letter-spacing: .04em; text-transform: uppercase;
    -webkit-text-fill-color: #fff;
}

/* ══════════════════════════════════════════════════════════════════════════
   FEATURE CARDS (HTML feature-grid) — readable by default
   ══════════════════════════════════════════════════════════════════════════ */
.feature-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
  gap: 1rem;
  margin-top: 1rem;
}

.feature-card {
  background: var(--surface) !important;
  border: 1px solid var(--border) !important;
  border-radius: var(--radius) !important;
  padding: 1.5rem !important;
  transition: all .25s ease !important;
  box-shadow: var(--shadow-sm) !important;
}

.feature-card .feature-icon {
  font-size: 1.8rem;
  margin-bottom: .5rem;
  color: var(--text-primary) !important;
  -webkit-text-fill-color: var(--text-primary) !important;
}

.feature-card .feature-title {
  font-weight: 600;
  font-size: .95rem;
  margin-bottom: .35rem;
  color: var(--text-primary) !important;
  -webkit-text-fill-color: var(--text-primary) !important;
}

.feature-card .feature-desc {
  font-size: .82rem;
  line-height: 1.5;
  color: var(--text-secondary) !important;
  -webkit-text-fill-color: var(--text-secondary) !important;
}

.feature-card:hover {
  box-shadow: var(--shadow-md) !important;
  transform: translateY(-3px);
  border-color: var(--accent) !important;
}

.feature-card:hover .feature-icon,
.feature-card:hover .feature-title {
  color: var(--accent) !important;
  -webkit-text-fill-color: var(--accent) !important;
}

.feature-card:hover .feature-desc {
  color: var(--text-primary) !important;
  -webkit-text-fill-color: var(--text-primary) !important;
}

/* ══════════════════════════════════════════════════════════════════════════
   STATUS DOT
   ══════════════════════════════════════════════════════════════════════════ */
.status-row {
    display: flex; align-items: center; gap: .55rem;
    padding: .4rem 0; font-size: .82rem;
}
.status-dot {
    width: 8px; height: 8px; border-radius: 50%;
    display: inline-block; flex-shrink: 0;
}
.status-dot.online  { background: #22C55E; box-shadow: 0 0 6px rgba(34,197,94,.5); }
.status-dot.offline { background: #EF4444; box-shadow: 0 0 6px rgba(239,68,68,.4); }

/* ══════════════════════════════════════════════════════════════════════════
   SIDEBAR METADATA CHIPS
   ══════════════════════════════════════════════════════════════════════════ */
.meta-chip {
    background: rgba(255,255,255,.05); border: 1px solid rgba(255,255,255,.08);
    border-radius: 8px; padding: .5rem .75rem; margin-bottom: .4rem; font-size: .78rem;
}
.meta-chip .label {
    color: rgba(255,255,255,.4) !important; text-transform: uppercase;
    font-size: .6rem; letter-spacing: .06em; font-weight: 600;
}
.meta-chip .value {
    color: #fff !important; font-weight: 500; margin-top: 2px;
}

/* ── Section heading in sidebar ──────────────────────── */
.sb-heading {
    font-size: .65rem; font-weight: 600; letter-spacing: .08em;
    text-transform: uppercase; color: rgba(255,255,255,.35) !important;
    padding: .3rem 0 .2rem; margin-top: .2rem;
}

/* ══════════════════════════════════════════════════════════════════════════
   FOOTER
   ══════════════════════════════════════════════════════════════════════════ */
.app-footer {
    text-align: center; padding: 1.5rem 0 1rem;
    font-size: .75rem; letter-spacing: .02em;
    color: var(--text-secondary) !important;
}
.app-footer a { color: var(--accent) !important; text-decoration: none; }

/* ══════════════════════════════════════════════════════════════════════════
   MISC
   ══════════════════════════════════════════════════════════════════════════ */
.block-container { padding-top: 2rem !important; }
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-thumb { background: #ccc; border-radius: 3px; }

/* ── Streamlit expander tweaks ───────────────────────── */
.stApp .main details summary span { color: var(--text-primary) !important; }

/* ══════════════════════════════════════════════════════════════════════════
   PILL BUTTONS — ULTIMATE (ONLY landing + conv containers)
   Dark pills with white text, fixes "color: inherit" wrappers.
   ══════════════════════════════════════════════════════════════════════════ */

/* Container wrappers (your st.container keys) */
div[data-testid="stVerticalBlockBorderWrapper"][data-test-key="pill_buttons_landing"],
div[data-testid="stVerticalBlockBorderWrapper"][data-test-key="pill_buttons_conv"]{
  background: transparent !important;
  border: none !important;
}

/* The actual buttons */
div[data-testid="stVerticalBlockBorderWrapper"][data-test-key="pill_buttons_landing"]
  div[data-testid="stButton"] > button,
div[data-testid="stVerticalBlockBorderWrapper"][data-test-key="pill_buttons_conv"]
  div[data-testid="stButton"] > button{
  background: rgb(19, 23, 32) !important;
  border: 1px solid rgba(250, 250, 250, 0.20) !important;
  border-radius: 999px !important;

  padding: .45rem 1rem !important;
  font-size: .82rem !important;
  font-weight: 500 !important;
  width: 100% !important;

  color: #ffffff !important;
  -webkit-text-fill-color: #ffffff !important;

  box-shadow: none !important;
  transition: all .2s ease !important;
}

/* Force nested label elements (handles "color: inherit") */
div[data-testid="stVerticalBlockBorderWrapper"][data-test-key="pill_buttons_landing"]
  div[data-testid="stButton"] > button *,
div[data-testid="stVerticalBlockBorderWrapper"][data-test-key="pill_buttons_conv"]
  div[data-testid="stButton"] > button *{
  color: #ffffff !important;
  -webkit-text-fill-color: #ffffff !important;
}

/* Hover: keep white text, add accent */
div[data-testid="stVerticalBlockBorderWrapper"][data-test-key="pill_buttons_landing"]
  div[data-testid="stButton"] > button:hover,
div[data-testid="stVerticalBlockBorderWrapper"][data-test-key="pill_buttons_conv"]
  div[data-testid="stButton"] > button:hover{
  border-color: var(--accent) !important;
  background: rgba(229, 9, 20, 0.12) !important;
  transform: none !important;
}

div[data-testid="stVerticalBlockBorderWrapper"][data-test-key="pill_buttons_landing"]
  div[data-testid="stButton"] > button:hover *,
div[data-testid="stVerticalBlockBorderWrapper"][data-test-key="pill_buttons_conv"]
  div[data-testid="stButton"] > button:hover *{
  color: #ffffff !important;
  -webkit-text-fill-color: #ffffff !important;
}

/* ══════════════════════════════════════════════════════════════════════════
   IMAGES INSIDE CHAT MESSAGES
   ══════════════════════════════════════════════════════════════════════════ */
.stChatMessage img {
    max-width: 100% !important;
    height: auto !important;
    border-radius: 8px;
    margin: .5rem 0;
    display: block;
}

/* ── Remove default gray / bg overrides inside messages ── */
.stChatMessage [data-testid="stMarkdownContainer"] {
    background: transparent !important;
}
.stChatMessage .stMarkdown {
    background: transparent !important;
}
